{% extends 'base.html' %}
{% load static %}
{% block title %}Clubs de Boxeo | Registro Partners{% endblock %}
{% block body_class %}d-flex flex-column min-vh-100{% endblock %}
{% block content %}
    <main class="flex-grow-1">
        <div class="container-fluid  px-3 py-5 ">
            <div class="col-8 mx-auto">
                <ul class="progress-steps mb-5">
                    <li class="step-item active" data-step="1" id="step-label-1"></li>
                    <li class="step-item" data-step="2" id="step-label-2"></li>
                    <li class="step-item" data-step="3" id="step-label-3"></li>
                    <li class="step-item" data-step="4" id="step-label-4"></li>
                </ul>
                <form method="post" class="profile-form mt-5" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{ form.non_field_errors }}
                    <input type="hidden"
                           name="current_step"
                           id="current-step"
                           value="{{ start_step }}">
                    <div id="step1" class="step  fade-step d-none">
                        <p class="text-muted text-center">Indícanos qué tipo de profesional eres.</p>
                        <div class="m-5 d-flex justify-content-center flex-wrap gap-3">
                            {% for radio in form.tipo %}
                                <label class="tipo-card">
                                    {{ radio.tag }}
                                    <div class="fw-medium">{{ radio.choice_label }}</div>
                                </label>
                            {% endfor %}
                        </div>
                        {% if form.tipo.errors %}
                            <div class="invalid-feedback d-block">{{ form.tipo.errors.as_text|striptags }}</div>
                        {% endif %}
                        <p class="text-center text-muted mb-5">
                            Elige la opción que mejor se adapte a tus necesidades y comienza a destacar en nuestro directorio.
                        </p>
                        {% include 'core/components/_plan_option_cards.html' %}
                        {% if form.plan.errors %}
                            <div class="invalid-feedback d-block">{{ form.plan.errors.as_text|striptags }}</div>
                        {% endif %}
                    </div>
                    <div id="step2" class="step fade-step d-none">{% include 'core/_pro_register_form.html' with form=pro_form %}</div>
                    <div id="step3" class="step fade-step d-none">
                        {% include 'core/_pro_extra_form.html' with form=extra_form coach_formset=coach_formset %}
                    </div>
                    <div id="step4" class="step fade-step d-none">
                        <div class="row g-5">
                            <div class="col-md-8">
                                <h1 class="h5 mb-3 text-center">Pasarela de pagos</h1>
                                <h2 class="h6">Dirección de facturación</h2>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="billing-same-address">
                                    <label class="form-check-label" for="billing-same-address">
                                        Utilizar la dirección del paso anterior
                                    </label>
                                </div>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="billing-first-name" class="form-label">Nombre</label>
                                        <input type="text" class="form-control" id="billing-first-name" name="billing_first_name">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="billing-last-name" class="form-label">Apellido</label>
                                        <input type="text" class="form-control" id="billing-last-name" name="billing_last_name">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="billing-id" class="form-label">DNI/NIE/NIF</label>
                                        <input type="text" class="form-control" id="billing-id" name="billing_id">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="billing-autonomy" class="form-label">Comunidad autónoma</label>
                                        <input type="text" class="form-control" id="billing-autonomy" name="billing_autonomy">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="billing-province" class="form-label">Provincia</label>
                                        <input type="text" class="form-control" id="billing-province" name="billing_province">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="billing-postal-code" class="form-label">Código postal</label>
                                        <input type="text" class="form-control" id="billing-postal-code" name="billing_postal_code">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="billing-street" class="form-label">Calle</label>
                                        <input type="text" class="form-control" id="billing-street" name="billing_street">
                                    </div>
                                    <div class="col-md-3">
                                        <label for="billing-number" class="form-label">Número</label>
                                        <input type="text" class="form-control" id="billing-number" name="billing_number">
                                    </div>
                                    <div class="col-md-3">
                                        <label for="billing-door" class="form-label">Puerta</label>
                                        <input type="text" class="form-control" id="billing-door" name="billing_door">
                                    </div>
                                </div>
                                <h2 class="h6 mt-4">Método de pago</h2>
                                <div class="mb-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="payment_method" id="payment-card" value="card" checked>
                                        <label class="form-check-label" for="payment-card">Tarjeta</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="payment_method" id="payment-bizum" value="bizum">
                                        <label class="form-check-label" for="payment-bizum">Bizum</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="payment_method" id="payment-transfer" value="transfer">
                                        <label class="form-check-label" for="payment-transfer">Transferencia</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="payment_method" id="payment-paypal" value="paypal">
                                        <label class="form-check-label" for="payment-paypal">Paypal</label>
                                    </div>
                                </div>
                                <div id="card-element" class="mb-3"></div>
                                <button type="button" class="btn btn-primary" id="stripe-connect-btn">Pagar</button>
                            </div>
                            <div class="col-md-4">
                                <h2 class="h6">Resumen de la compra</h2>
                                <div id="order-summary"></div>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex mt-4">
                        <button type="button" class="btn btn-outline-dark d-none" id="prevBtn">Atrás</button>
                        <div class="ms-auto d-flex gap-2">
                            <button type="button" class="btn btn-dark" id="nextBtn">Continuar</button>
                            <button type="submit" class="btn btn-dark d-none" id="finishBtn">Finalizar</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </main>
{% endblock %}
{% block extra_js %}
    <script>window.stripePublicKey = "{{ stripe_public_key }}";</script>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="{% static 'js/member-location.js' %}"></script>
    <script src="{% static 'js/avatar-dropzone.js' %}"></script>
    <script src="{% static 'js/feature-select.js' %}"></script>
    <script src="{% static 'js/coach-feature-select.js' %}"></script>
    <script src="{% static 'js/pro-registro.js' %}"></script>
    <script src="{% static 'js/about-placeholder.js' %}"></script>
{% endblock %}
