{% extends 'base.html' %}
{% load static %}
{% block title %}Clubs de Boxeo | Registro Partners{% endblock %}
{% block body_class %}d-flex flex-column min-vh-100{% endblock %}
{% block content %}
    <main class="flex-grow-1">
        <div class="container-fluid  px-3 py-5 ">
            <div class="col-8 mx-auto">
                <ul class="progress-steps mb-5">
                    <li class="step-item active" data-step="1" id="step-label-1"></li>
                    <li class="step-item" data-step="2" id="step-label-2"></li>
                    <li class="step-item" data-step="3" id="step-label-3"></li>
                    <li class="step-item" data-step="4" id="step-label-4"></li>
                </ul>
                <form method="post" class="profile-form mt-5" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{ form.non_field_errors }}
                    <input type="hidden"
                           name="current_step"
                           id="current-step"
                           value="{{ start_step }}">
                    <div id="step1" class="step  fade-step d-none">
                        <p class="text-muted text-center">Indícanos qué tipo de profesional eres.</p>
                        <div class="m-5 d-flex justify-content-center flex-wrap gap-3">
                            {% for radio in form.tipo %}
                                <label class="tipo-card">
                                    {{ radio.tag }}
                                    <div class="fw-medium">{{ radio.choice_label }}</div>
                                </label>
                            {% endfor %}
                        </div>
                        {% if form.tipo.errors %}
                            <div class="invalid-feedback d-block">{{ form.tipo.errors.as_text|striptags }}</div>
                        {% endif %}
                        <p class="text-center text-muted mb-5">
                            Elige la opción que mejor se adapte a tus necesidades y comienza a destacar en nuestro directorio.
                        </p>
                        {% include 'core/components/_plan_option_cards.html' %}
                        {% if form.plan.errors %}
                            <div class="invalid-feedback d-block">{{ form.plan.errors.as_text|striptags }}</div>
                        {% endif %}
                    </div>
                    <div id="step2" class="step fade-step d-none">{% include 'core/_pro_register_form.html' with form=pro_form %}</div>
                    <div id="step3" class="step fade-step d-none">
                        {% include 'core/_pro_extra_form.html' with form=extra_form coach_formset=coach_formset %}
                    </div>
                    <div id="step4" class="step fade-step d-none">
                        <h1 class="h5 mb-3 text-center">Resumen y pago</h1>
                        <div class="mb-3">
                            <p class="mb-1">Plan seleccionado:</p>
                            <div id="plan-summary" class="fw-medium"></div>
                        </div>
                        <div class="mb-3">
                            <p class="mb-1">Dirección de facturación</p>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="billing-same" checked>
                                <label class="form-check-label" for="billing-same">Usar la dirección anterior</label>
                            </div>
                            <div id="billing-fields" class="row g-2 mt-2 d-none">
                                <div class="col-md-8">
                                    <input type="text" id="billing-line1" class="form-control" placeholder="Dirección">
                                </div>
                                <div class="col-md-4">
                                    <input type="text" id="billing-postal" class="form-control" placeholder="Código postal">
                                </div>
                                <div class="col-md-6">
                                    <input type="text" id="billing-city" class="form-control" placeholder="Ciudad">
                                </div>
                                <div class="col-md-6">
                                    <input type="text" id="billing-country" class="form-control" placeholder="País">
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="cardholder-name" class="form-label">Nombre y apellidos</label>
                            <input type="text" id="cardholder-name" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label for="card-element" class="form-label">Datos de la tarjeta</label>
                            <div id="card-element" class="form-control"></div>
                        </div>
                        <div id="payment-message" class="text-danger small mt-2"></div>
                        <input type="hidden" name="payment_intent_id" id="payment_intent_id">
                    </div>
                    <div class="d-flex mt-4">
                        <button type="button" class="btn btn-outline-dark d-none" id="prevBtn">Atrás</button>
                        <div class="ms-auto d-flex gap-2">
                            <button type="button" class="btn btn-dark" id="nextBtn">Continuar</button>
                            <button type="submit" class="btn btn-dark d-none" id="finishBtn">Finalizar</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </main>
{% endblock %}
{% block extra_js %}
    <script>window.stripePublicKey = "{{ stripe_public_key }}";</script>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="{% static 'js/member-location.js' %}"></script>
    <script src="{% static 'js/avatar-dropzone.js' %}"></script>
    <script src="{% static 'js/feature-select.js' %}"></script>
    <script src="{% static 'js/coach-feature-select.js' %}"></script>
    <script src="{% static 'js/pro-registro.js' %}"></script>
    <script src="{% static 'js/about-placeholder.js' %}"></script>
{% endblock %}
