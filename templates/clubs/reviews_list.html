{% load star_rating %}
{% for reseña in reseñas %}
  <div class="mb-3 rounded position-relative">
    <div class="row justify-content-between">
      <div class="col-1 d-flex flex-column align-items-start justify-content-start">
        {% if reseña.usuario.profile.avatar %}
          <img style="height:50px; width:50px;" src="{{ reseña.usuario.profile.avatar.url }}" alt="{{ reseña.usuario.username }}" class="review-avatar-img rounded-circle">
        {% else %}
          <div style="height:50px; width:50px;" class="review-avatar d-flex align-items-center justify-content-center rounded-circle">
            {{ reseña.usuario.username|first|upper }}
          </div>
        {% endif %}
        <div class="fw-medium mt-2 small text-center">{{ reseña.usuario.username }}</div>
      </div>
      <div class="col-11">
        <div class="d-flex justify-content-between align-items-start mb-2">
          <div>
            <h5 class="mt-0 mb-1">{{ reseña.titulo }}</h5>
            <div class="text-muted small">{{ reseña.creado|date:"SHORT_DATE_FORMAT" }}</div>
          </div>
          <div class="d-flex flex-column align-items-end fw-bold">
            <span>{{ reseña.promedio }} <small style="font-size:12px;">/ 5</small></span>
            <span class="fs-1 d-flex">{% render_stars reseña.promedio %}</span>
          </div>
        </div>
        <div>
          <p class="mt-3 mb-3" style="text-align: justify;">{{ reseña.comentario }}</p>
        </div>
        {% if user.is_authenticated and user == reseña.usuario %}
          <div class="mt-2 d-flex justify-content-end align-items-end">
            <a href="{% url 'editar_reseña' reseña.id %}" class="btn btn-sm btn-link">
              <svg  style="height:15px;" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M495.6 49.23..."/></svg>
            </a>
            <form action="{% url 'eliminar_reseña' reseña.id %}" method="post" class="d-inline">
              {% csrf_token %}
              <button type="submit" class="btn btn-sm btn-link text-danger">
                <svg style="height:15px;" viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M432 80h-82.38..."/></svg>
              </button>
            </form>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
{% empty %}
  <p class="text-muted">Este club todavía no tiene comentarios escritos.</p>
{% endfor %}
{% if reseñas.has_other_pages %}
<nav class="mt-4" aria-label="Paginar valoraciones">
  <ul class="pagination justify-content-center ajax" data-target="review-list">
    {% if reseñas.has_previous %}
      <li class="page-item"><a class="page-link" href="{% url 'ajax_reviews' club.slug %}?review_page={{ reseñas.previous_page_number }}{% if orden %}&orden={{ orden }}{% endif %}">«</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">«</span></li>
    {% endif %}
    {% for num in reseñas.paginator.page_range %}
      {% if reseñas.number == num %}
        <li class="page-item active"><span class="page-link">{{ num }}</span></li>
      {% else %}
        <li class="page-item"><a class="page-link" href="{% url 'ajax_reviews' club.slug %}?review_page={{ num }}{% if orden %}&orden={{ orden }}{% endif %}">{{ num }}</a></li>
      {% endif %}
    {% endfor %}
    {% if reseñas.has_next %}
      <li class="page-item"><a class="page-link" href="{% url 'ajax_reviews' club.slug %}?review_page={{ reseñas.next_page_number }}{% if orden %}&orden={{ orden }}{% endif %}">»</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">»</span></li>
    {% endif %}
  </ul>
</nav>
{% endif %}
