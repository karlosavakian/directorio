{% extends 'base.html' %} {% load static utils_filters %} {% block content %}

<div class="d-flex mt-5 mb-5 container-fluid col-12 ">
  <div class="profile-tabs">
    <div class="profile-tab active" data-target="tab-profile">Mi perfil</div>
    <div class="profile-tab" data-target="tab-gallery">Galería</div>
    <div class="profile-tab" data-target="tab-schedule">Horarios</div>
    <div class="profile-tab" data-target="tab-coaches">Entrenadores</div>
    <div class="profile-tab" data-target="tab-competitors">Competidores</div>
    <div class="profile-tab" data-target="tab-members">Miembros</div>
    <div class="profile-tab" data-target="tab-bookings">Reservas</div>
  </div>
  <div class="profile-content">
    <div id="tab-profile" class="profile-section active">
      <h1 class="h3 mb-4">Administrar {{ club.name }}</h1>
      <form
        method="post"
        action="{% url 'club_edit' club.slug %}"
        enctype="multipart/form-data"
        class="profile-form"
      >
        {% csrf_token %}
        <div class="form-field">
          <div class="avatar-dropzone mx-auto">
            {{ form.logo }}
            <div class="avatar-preview{% if club.logo|safe_url %} has-image{% endif %}"{% if club.logo|safe_url %} style="background-image:url('{{ club.logo|safe_url }}')"{% endif %}>
              <div class="avatar-dropzone-msg">
                <i class="bi bi-cloud-upload mb-1 fs-4"></i>
                <span>Sube tu logo</span>
              </div>
            </div>
          </div>
          <label for="{{ form.logo.id_for_label }}"
            >{{ form.logo.label }}</label
          >
          {% if form.logo.errors %}
          <div class="invalid-feedback d-block">
            {{ form.logo.errors.as_text|striptags }}
          </div>
          {% endif %}
        </div>
        <div class="form-field">
          {{ form.owner }}
          <label for="{{ form.owner.id_for_label }}"
            >{{ form.owner.label }}</label
          >
          {% if form.owner.errors %}
          <div class="invalid-feedback d-block">
            {{ form.owner.errors.as_text|striptags }}
          </div>
          {% endif %}
        </div>
        <div class="form-field">
          {{ form.name }}
          <button type="button" class="clear-btn">×</button>
          <label for="{{ form.name.id_for_label }}"
            >{{ form.name.label }}</label
          >
          {% if form.name.errors %}
          <div class="invalid-feedback d-block">
            {{ form.name.errors.as_text|striptags }}
          </div>
          {% endif %}
        </div>
        <div class="form-field">
          {{ form.about }}
          <label for="{{ form.about.id_for_label }}"
            >{{ form.about.label }}</label
          >
          {% if form.about.errors %}
          <div class="invalid-feedback d-block">
            {{ form.about.errors.as_text|striptags }}
          </div>
          {% endif %}
        </div>
        <div class="form-field">
          {{ form.city }}
          <button type="button" class="clear-btn">×</button>
          <label for="{{ form.city.id_for_label }}"
            >{{ form.city.label }}</label
          >
          {% if form.city.errors %}
          <div class="invalid-feedback d-block">
            {{ form.city.errors.as_text|striptags }}
          </div>
          {% endif %}
        </div>
        <div class="form-field">
          {{ form.address }}
          <button type="button" class="clear-btn">×</button>
          <label for="{{ form.address.id_for_label }}"
            >{{ form.address.label }}</label
          >
          {% if form.address.errors %}
          <div class="invalid-feedback d-block">
            {{ form.address.errors.as_text|striptags }}
          </div>
          {% endif %}
        </div>
        <div class="form-field">
          {{ form.phone }}
          <button type="button" class="clear-btn">×</button>
          <label for="{{ form.phone.id_for_label }}"
            >{{ form.phone.label }}</label
          >
          {% if form.phone.errors %}
          <div class="invalid-feedback d-block">
            {{ form.phone.errors.as_text|striptags }}
          </div>
          {% endif %}
        </div>
        <div class="form-field">
          {{ form.whatsapp_link }}
          <button type="button" class="clear-btn">×</button>
          <label for="{{ form.whatsapp_link.id_for_label }}"
            >{{ form.whatsapp_link.label }}</label
          >
          {% if form.whatsapp_link.errors %}
          <div class="invalid-feedback d-block">
            {{ form.whatsapp_link.errors.as_text|striptags }}
          </div>
          {% endif %}
        </div>
        <div class="form-field">
          {{ form.email }}
          <button type="button" class="clear-btn">×</button>
          <label for="{{ form.email.id_for_label }}"
            >{{ form.email.label }}</label
          >
          {% if form.email.errors %}
          <div class="invalid-feedback d-block">
            {{ form.email.errors.as_text|striptags }}
          </div>
          {% endif %}
        </div>
        <div class="form-field">
          <h5 class="d-block mb-2">{{ form.features.label }}</h5>
          <div class="d-flex flex-wrap gap-3" id="features-container">
            {% for feature in form.features.field.queryset %}
            <div
              class="feature-option border rounded d-flex align-items-center {% if feature in club.features.all %}selected{% endif %}"
              style="padding: 8px 16px"
            >
              <input
                type="checkbox"
                name="features"
                value="{{ feature.id }}"
                class="d-none"
                {%
                if
                feature
                in
                club.features.all
                %}
                checked{%
                endif
                %}
              />
              {% if feature.icon %}
              <img
                src="{{ feature.icon.url }}"
                alt="{{ feature.name }}"
                style="
                  width: 50px;
                  height: 50px;
                  object-fit: contain;
                  user-select: none;
                "
                class="me-2"
              />
              {% endif %}
              <div class="text-wrap" style="font-size: 14px; user-select: none">
                {{ feature.name }}
              </div>
            </div>
            {% endfor %}
          </div>
          {% if form.features.errors %}
          <div class="invalid-feedback d-block">
            {{ form.features.errors.as_text|striptags }}
          </div>
          {% endif %}
        </div>
        <div class="form-field">
          {{ form.category }}
          <label for="{{ form.category.id_for_label }}"
            >{{ form.category.label }}</label
          >
          {% if form.category.errors %}
          <div class="invalid-feedback d-block">
            {{ form.category.errors.as_text|striptags }}
          </div>
          {% endif %}
        </div>
        <button type="submit" class="btn btn-dark">Guardar</button>
      </form>
    </div>
    <div id="tab-gallery" class="profile-section ">
   <div class="d-flex justify-content-between align-items-center mb-3">
  <!-- Col izquierda: Añadir fotos -->
  <div>
    <form
      id="upload-form"
      method="post"
      enctype="multipart/form-data"
      action="{% url 'clubphoto_upload' club.slug %}"
      class="mb-0"
    >
      {% csrf_token %}
      <input
        type="file"
        name="image"
        id="id_gallery_image"
        multiple
        class="d-none"
      />
      <button
        type="button"
        id="add-photos-btn"
        class="btn btn-sm btn-outline-dark d-inline-flex align-items-center gap-2"
      >
        <i class="bi bi-plus-circle icon-large"></i> Añadir fotos
      </button>
    </form>
  </div>

  <!-- Col derecha: botones de acciones -->
  <div class="d-flex align-items-center gap-3">
          <button
            type="button"
            id="select-all"
            class="bg-transparent border-0 fw-medium text-black"
          >
            Seleccionar todas
          </button>

          <button
            type="button"
            id="deselect-all"
            class="bg-transparent border-0 fw-medium text-secondary"
          >
            Desmarcar todas
          </button>

          <form
            id="bulk-delete-form"
            method="post"
            action="{% url 'clubphoto_bulk_delete' club.slug %}"
            class="d-inline mb-0"
          >
            {% csrf_token %}
            <input type="hidden" name="ids" id="delete-ids" />
            <button
              type="submit"
              id="delete-selected"
              class="bg-transparent border-0 fw-medium text-secondary"
            >
              Eliminar
            </button>
          </form>
        </div>
      </div>

      <div id="gallery-grid" class="gallery-grid">
        {% for photo in club.photos.all %}
        <div
          class="gallery-item position-relative{% if photo.is_main %} main{% endif %}"
          draggable="true"
          data-id="{{ photo.id }}"
        >
          <img
            src="{{ photo.image.url }}"
            alt="foto"
            class="w-100 h-100 object-fit-cover rounded"
          />
          <div class="small photo-dimensions">
            {{ photo.image.width }}x{{ photo.image.height }}px
          </div>
          <input
            type="checkbox"
            class="photo-checkbox"
            value="{{ photo.id }}"
          />
          <div class="gallery-hover-actions">
            <span class="drag-handle bi bi-arrows-move  "></span>
            <div class="dropdown">
              <button
                class="btn btn-light btn-sm dropdown-toggle"
                type="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Opciones
              </button>
              <ul class="dropdown-menu">
                <li>
                  <form method="post" action="{% url 'clubphoto_set_main' photo.id %}">
                    {% csrf_token %}
                    <button type="submit" class="dropdown-item">Destacar</button>
                  </form>
                </li>
                <li>
                  <form method="post" action="{% url 'clubphoto_delete' photo.id %}">
                    {% csrf_token %}
                    <button type="submit" class="dropdown-item text-danger">Eliminar</button>
                  </form>
                </li>
              </ul>
            </div>
          </div>
          {% if photo.is_main %}
          <span class="bi bi-pin-angle-fill main-pin "></span>
          {% endif %}
        </div>
        {% empty %}
        <p>No hay fotos.</p>
        {% endfor %}
      </div>
    </div>
    <div id="tab-schedule" class="profile-section">
      
      <h2 class="h5 mt-4">Horarios</h2>
      <div class="table-responsive">
        <table
          class="table table-bordered text-center align-middle"
          style="min-width: 700px"
        >
          <thead class="table-dark">
            <tr>
              {% for dia, nombre in dias_semana %}
              <th scope="col">{{ nombre }}</th>
              {% endfor %}
            </tr>
          </thead>
          <tbody>
            <tr>
              {% for dia, nombre in dias_semana %}
                    <td style=" vertical-align: top;">
                <!-- Botón añadir -->
                <div class="mb-3  ">
              <button
            class="btn btn-sm btn-outline-dark w-100 h-50"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#add-{{ dia }}"
            aria-expanded="false"
            aria-controls="add-{{ dia }}"
          >
            <i class="bi bi-plus-circle"></i> Añadir
          </button>

                  <div class="collapse mt-2" id="add-{{ dia }}">
                    <form
                      method="post"
                      action="{% url 'horario_create' club.slug %}"
                    >
                      {% csrf_token %}
                      <input type="hidden" name="dia" value="{{ dia }}" />
                      <div class="row g-2">
                        <div class="col">
                          <input
                            type="time"
                            name="hora_inicio"
                            class="form-control form-control-sm"
                            required
                          />
                        </div>
                        <div class="col">
                          <input
                            type="time"
                            name="hora_fin"
                            class="form-control form-control-sm"
                            required
                          />
                        </div>
                        <div class="col">
                          <select
                            name="estado"
                            class="form-select form-select-sm"
                          >
                            <option value="abierto">Abierto</option>
                            <option value="cerrado">Cerrado</option>
                            <option value="otro">Otro</option>
                          </select>
                        </div>
                        <div class="col" style="display: none">
                          <input type="text" name="estado_otro" class="form-control form-control-sm" maxlength="30" placeholder="Especificar" />
                        </div>
                        <div class="col-auto">
                          <button type="submit" class="btn btn-sm btn-dark">
                            Guardar
                          </button>
                        </div>
                      </div>
                    </form>
                  </div>
                </div> 

                {% for bloque in horarios_por_dia|get_item:dia %}
                <div
                  class="small  fw-medium d-flex justify-content-between align-items-center border rounded p-1 mb-1"
                >
                
                  <span>
                    {% if bloque.estado == 'abierto' %}
                    {{ bloque.hora_inicio|time:'H:i' }} -
                    {{ bloque.hora_fin|time:'H:i' }}
                    {% elif bloque.estado == 'cerrado' %}
                    <span class="text-danger">Cerrado</span>
                    {% else %}
                    <span class="text-muted">{{ bloque.estado_otro }}</span>
                    {% endif %}
                  </span>
                  <span>
                    <!-- Editar -->
                    <a
                      data-bs-toggle="collapse"
                      href="#edit-{{ bloque.id }}"
                      role="button"
                      aria-expanded="false"
                      aria-controls="edit-{{ bloque.id }}"
                      class="btn btn-sm btn-link  "
                    >
                     <i class="bi bi-pencil-square icon-large"></i>
                     
                    </a>
                    <!-- Borrar -->
                    <form
                      method="post"
                      action="{% url 'horario_delete' bloque.id %}"
                      class="d-inline"
                    >
                      {% csrf_token %}
                      <button
                        type="submit"
                        class="btn btn-sm btn-link text-danger"
                      >
                        <i class= "bi bi-dash-circle icon-large"></i>
                      </button>
                    </form>
                  </span>
                </div>
                <!-- Collapse para editar -->
                <div class="collapse" id="edit-{{ bloque.id }}">
                  <form
                    method="post"
                    action="{% url 'horario_update' bloque.id %}"
                  >
                    {% csrf_token %}
                    <input type="hidden" name="dia" value="{{ bloque.dia }}" />
                    <div class="row g-2 mt-2">
                      <div class="col">
                        <input
                          type="time"
                          name="hora_inicio"
                          value="{{ bloque.hora_inicio|time:'H:i' }}"
                          class="form-control form-control-sm"
                          required
                        />
                      </div>
                      <div class="col">
                        <input
                          type="time"
                          name="hora_fin"
                          value="{{ bloque.hora_fin|time:'H:i' }}"
                          class="form-control form-control-sm"
                          required
                        />
                      </div>
                      <div class="col">
                        <select
                          name="estado"
                          class="form-select form-select-sm"
                        >
                          <option
                            value="abierto"
                            {%
                            if
                            bloque.estado=""
                            ="abierto"
                            %}selected{%
                            endif
                            %}
                          >
                            Abierto
                          </option>
                          <option
                            value="cerrado"
                            {%
                            if
                            bloque.estado=""
                            ="cerrado"
                            %}selected{%
                            endif
                            %}
                          >
                            Cerrado
                          </option>
                          <option value="otro" {% if bloque.estado == 'otro' %}selected{% endif %}>Otro</option>
                        </select>
                      </div>
                      <div class="col" style="display: none">
                        <input type="text" name="estado_otro" value="{{ bloque.estado_otro }}" class="form-control form-control-sm" maxlength="30" placeholder="Especificar" />
                      </div>
                      <div class="col-auto">
                        <button type="submit" class="btn btn-sm btn-dark">
                          Guardar
                        </button>
                      </div>
                    </div>
                  </form>
                </div>
                {% empty %}
                <small class="text-muted">Sin horarios</small>
                {% endfor %}


              </td>
              {% endfor %}
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div id="tab-coaches" class="profile-section">
      <button type="button" class="btn btn-outline-dark mb-3 d-inline-flex align-items-center justify-content-center gap-2 btn-sm add-coach-btn" data-club-slug="{{ club.slug }}">
        <i class="bi bi-plus-circle icon-large"></i> Añadir entrenador
      </button>
  
      <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-4">
        {% for coach in club.entrenadores.all %}
        <div class="col">
          <div class="card h-100 text-center">
  {% if coach.avatar %}
    <img src="{{ coach.avatar.url }}" class="card-img-top object-fit-cover" style="height:250px" alt="{{ coach.nombre }}">
  {% else %}
    <div class="card-img-top d-flex align-items-center justify-content-center bg-light" style="height:250px;">
      <span class="text-muted">{{ coach.nombre|first|upper }}</span>
    </div>
  {% endif %}

  <div class="card-body p-2">
    <!-- Nombre centrado -->
    <span class="fw-medium text-center mb-2">{{ coach.nombre }} {{ coach.apellidos }}</span>

    <!-- Iconos debajo del nombre, centrados -->
    <div class="mt-2 d-flex justify-content-center gap-2">
      <a href="{% url 'entrenador_update' coach.id %}" class="bi bi-pencil-square icon-large text-decoration-none d-flex align-items-center p-0"></a>

      <form method="post" action="{% url 'entrenador_delete' coach.id %}" class="m-0 p-0 delete-profile-form">
        {% csrf_token %}
        <button type="submit" class="bi bi-dash-circle icon-large btn btn-link text-danger text-decoration-none p-0 m-0  d-flex align-items-center"></button>
      </form>
    </div>
  </div>
</div>

        </div>
        {% empty %}
        <p>No hay entrenadores.</p>
        {% endfor %}
      </div>
    </div>
    <div id="tab-competitors" class="profile-section">

      <button type="button" class="btn btn-sm btn-outline-dark d-inline-flex align-items-center justify-content-center gap-2 btn-sm add-competitor-btn mb-3" data-club-slug="{{ club.slug }}">
    <i class="bi bi-plus-circle icon-large"></i> Añadir competidor
  </button>

      <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-4">
        {% for comp in club.competidores.all %}
        <div class="col">
          <div class="card  text-center">
            {% if comp.avatar %}
              <img src="{{ comp.avatar.url }}" class="card-img-top object-fit-cover" style="height:200px" alt="{{ comp.nombre }}">
            {% else %}
              <div class="card-img-top d-flex align-items-center justify-content-center bg-light" style="height:200px;">
                <span class="text-muted">{{ comp.nombre|initials }}</span>
              </div>
            {% endif %}
            <div class="card-body p-2 d-flex flex-column justify-content-between">
  <!-- Nombre centrado -->
  <div class="d-flex justify-content-center align-items-center mb-2">
    <span class="fw-medium text-center">{{ comp.nombre }}</span>
  </div>

  <!-- Información del competidor -->
  <small class="text-center mb-2">
    {% with rec=comp.record_tuple %}
      <span class="fw-bold text-success">{{ rec.0 }}</span>-
      <span class="fw-bold text-danger">{{ rec.1 }}</span>-
      <span class="fw-bold text-primary">{{ rec.2 }}</span> 
    {% endwith %}
    <br>
    <span>{{ comp.categoria }}</span>
  </small>

  <!-- Iconos abajo, centrados -->
  <div class="mt-1 d-flex justify-content-center gap-2">
    <a href="{% url 'competidor_update' comp.id %}" class="bi bi-pencil-square icon-large text-decoration-none d-flex align-items-center p-0"></a>

    <form method="post" action="{% url 'competidor_delete' comp.id %}" class="d-flex align-items-center p-0 m-0 delete-profile-form">
      {% csrf_token %}
      <button type="submit" class="bi bi-dash-circle icon-large text-decoration-none btn btn-link text-danger p-0 m-0 d-flex align-items-center"></button>
    </form>
  </div>
</div>

               
          </div>
        </div>
        {% empty %}
        <p>No hay competidores.</p>
        {% endfor %}
      </div>
    </div>
    <div id="tab-members" class="profile-section">
      <button type="button" class="btn btn-sm btn-outline-dark d-inline-flex align-items-center justify-content-center gap-2 btn-sm add-member-btn mb-3" data-club-slug="{{ club.slug }}">
        <i class="bi bi-plus-circle icon-large"></i> Añadir miembro
      </button>
      <form method="get" id="member-search-form" class="d-inline-flex align-items-center gap-2 ms-2 mb-3">
        <button type="button" id="member-search-toggle" class="btn btn-outline-dark"><i class="bi bi-search"></i></button>
        <div id="member-search-wrapper" class="member-search-wrapper ms-2 form-field search-field">
          <input type="text" name="q" id="member-search-input" list="member-list" class="form-control form-control-sm member-search-input" placeholder="Buscar miembro" value="{{ request.GET.q }}">
          <button type="button" class="clear-btn">&times;</button>
          <i class="bi bi-search search-icon"></i>
          <button type="submit" class="btn btn-outline-dark btn-sm search-submit"><i class="bi bi-search"></i></button>
        </div>
        <datalist id="member-list">
          {% for mem in club.miembros.all %}
          <option value="{{ mem.nombre }} {{ mem.apellidos }}"></option>
          {% endfor %}
        </datalist>
      </form>
      <div class="row g-3">
        <div class="col-lg-9">
          <div class="table-responsive">
            <table class="table table-bordered text-center align-middle" style="min-width: 600px">
          <thead class="table-dark">
            <tr>
              <th>Miembro</th>
              <th>Teléfono</th>
              <th>Email</th>
              <th>Inscrito</th>
              <th>Estado</th>
              <th>Pagos</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            {% for m in members %}
            <tr>
              <td>
                {{ m.nombre }} {{ m.apellidos }}
                <button type="button" class="btn btn-sm btn-link view-member-btn text-dark" data-member-id="{{ m.id }}">
                  <i class="bi bi-eye icon-large text-dark"></i>
                </button>
              </td>
              <td>{{ m.telefono }}</td>
              <td>{{ m.email }}</td>
              <td>{{ m.fecha_inscripcion|date:"d/m/Y" }}</td>
              <td>
                {% if m.estado == 'activo' %}
                <span class="badge p-2 bg-success ">Activo</span>
                {% else %}
                <span class="badge  p-2bg-secondary">Inactivo</span>
                {% endif %}
              </td>
              <td>
                {% if m.pago_mes_actual == 'completo' %}
                <span class="badge p-2 bg-primary">Completo</span>
                {% else %}
                <span class="badge p-2 bg-warning text-dark">Pendiente</span>
                {% endif %}
                <button type="button" class="btn btn-sm btn-link view-payments-btn text-dark" data-member-id="{{ m.id }}">
                  <i class="bi bi-eye icon-large text-dark"></i>
                </button>
              </td>
              <td>
                <button type="button" class="btn btn-sm btn-link edit-member-btn text-dark" data-member-id="{{ m.id }}">
                  <i class="bi bi-pencil-square icon-large text-dark"></i>
                </button>
                <form method="post" action="{% url 'miembro_delete' m.id %}" class="d-inline delete-profile-form">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-sm btn-link text-danger">
                    <i class="bi bi-dash-circle icon-large"></i>
                  </button>
                </form>
              </td>
            </tr>
            {% empty %}
            <tr class="no-members-row">
              <td colspan="7" class="text-muted">No hay miembros.</td>
            </tr>
            {% endfor %}
          </tbody>
            </table>
          </div>
        </div>
        <div class="col-lg-2">
          <form method="get" id="member-search-form" class="mb-3">
            <div class="input-group input-group-sm form-field search-field">
              <input type="text" name="q" class="form-control" placeholder="Buscar miembro" value="{{ request.GET.q }}">
              <button type="button" class="clear-btn">&times;</button>
              <i class="bi bi-search search-icon"></i>
              <button type="submit" class="btn btn-outline-dark"><i class="bi bi-search"></i></button>
            </div>
          </form>
          <form method="get" id="member-filter-form" class="vstack gap-2">
            <select name="orden" class="form-select form-select-sm">
              <option value="alpha" {% if request.GET.orden == 'alpha' %}selected{% endif %}>Alfabético A-Z</option>
              <option value="alpha_desc" {% if request.GET.orden == 'alpha_desc' %}selected{% endif %}>Alfabético Z-A</option>
              <option value="oldest" {% if request.GET.orden == 'oldest' %}selected{% endif %}>Más antiguos primero</option>
              <option value="newest" {% if request.GET.orden == 'newest' %}selected{% endif %}>Más recientes primero</option>
            </select>
            <div>
              <span class="d-block small fw-bold">Estado</span>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" name="estado" id="estado-activo" value="activo" {% if 'activo' in request.GET|get_list:'estado' %}checked{% endif %}>
                <label class="form-check-label" for="estado-activo">Activo</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" name="estado" id="estado-inactivo" value="inactivo" {% if 'inactivo' in request.GET|get_list:'estado' %}checked{% endif %}>
                <label class="form-check-label" for="estado-inactivo">Inactivo</label>
              </div>
            </div>
            <div>
              <span class="d-block small fw-bold">Pago</span>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" name="pago" id="pago-completo" value="completo" {% if 'completo' in request.GET|get_list:'pago' %}checked{% endif %}>
                <label class="form-check-label" for="pago-completo">Completo</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" name="pago" id="pago-pendiente" value="pendiente" {% if 'pendiente' in request.GET|get_list:'pago' %}checked{% endif %}>
                <label class="form-check-label" for="pago-pendiente">Pendiente</label>
              </div>
            </div>
            <div>
              <span class="d-block small fw-bold">Sexo</span>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" name="sexo" id="sexo-M" value="M" {% if 'M' in request.GET|get_list:'sexo' %}checked{% endif %}>
                <label class="form-check-label" for="sexo-M">Masculino</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="checkbox" name="sexo" id="sexo-F" value="F" {% if 'F' in request.GET|get_list:'sexo' %}checked{% endif %}>
                <label class="form-check-label" for="sexo-F">Femenino</label>
              </div>
            </div>
              <span class="d-block small fw-bold">Peso</span>
              <div class="row g-2">
                <div class="col">
                  <input type="number" step="0.01" name="peso_min" class="form-control form-control-sm" placeholder="Peso mín" value="{{ request.GET.peso_min }}">
                </div>
                <div class="col">
                  <input type="number" step="0.01" name="peso_max" class="form-control form-control-sm" placeholder="Peso máx" value="{{ request.GET.peso_max }}">
                </div>
              </div>
              <span class="d-block small fw-bold">Altura</span>
              <div class="row g-2">
                <div class="col">
                  <input type="number" step="0.01" name="altura_min" class="form-control form-control-sm" placeholder="Altura mín" value="{{ request.GET.altura_min }}">
                </div>
                <div class="col">
                  <input type="number" step="0.01" name="altura_max" class="form-control form-control-sm" placeholder="Altura máx" value="{{ request.GET.altura_max }}">
                </div>
              </div>
              <div class="text-end">
                <button type="submit" class="btn btn-dark btn-sm">Filtrar</button>
              </div>
          </form>
        </div>
      </div>
    </div>
    <div id="tab-bookings" class="profile-section">
      <ul>
        {% for b in bookings %}
        <li>
          {{ b.user.username }} - {{ b.evento.titulo }} ({{ b.status }})
        </li>
        {% empty %}
        <li>No hay reservas.</li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>
<!-- Confirm Delete Modal -->
<div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Confirmar eliminación</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        ¿Seguro que deseas eliminar este perfil?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-danger confirm-delete">Eliminar</button>
      </div>
    </div>
  </div>
</div>

<!-- Confirm Edit Modal -->
<div class="modal fade" id="confirmEditModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Confirmar cambios</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        ¿Seguro que deseas guardar los cambios?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary confirm-edit">Guardar</button>
      </div>
    </div>
  </div>
</div>

<!-- Payment History Modal -->
<div class="modal fade" id="paymentHistoryModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Historial de Pagos</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body"></div>
    </div>
  </div>
</div>

<!-- Member Profile Modal -->
<div class="modal fade" id="memberProfileModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Perfil de Miembro</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body"></div>
    </div>
  </div>
</div>

<!-- Edit Member Modal -->
<div class="modal fade" id="editMemberModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar miembro</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-5"></div>
    </div>
  </div>
</div>

<!-- Add Member Modal -->
<div class="modal fade" id="addMemberModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Nuevo miembro</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body"></div>
    </div>
  </div>
</div>

<!-- Add Coach Modal -->
<div class="modal fade" id="addCoachModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Nuevo entrenador</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body"></div>
    </div>
  </div>
</div>

<!-- Add Competitor Modal -->
<div class="modal fade" id="addCompetitorModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Nuevo competidor</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body"></div>
    </div>
  </div>
</div>

{% endblock %} {% block extra_js %}
<script src="{% static 'js/profile-tabs.js' %}"></script>
<script src="{% static 'js/feature-select.js' %}"></script>
<script src="{% static 'js/avatar-dropzone.js' %}"></script>
<script src="{% static 'js/schedule-form.js' %}"></script>
<script src="{% static 'js/gallery-manager.js' %}"></script>
<script src="{% static 'js/delete-confirm.js' %}"></script>
<script src="{% static 'js/payment-history.js' %}"></script>
<script src="{% static 'js/member-modal.js' %}"></script>
<script src="{% static 'js/coach-modal.js' %}"></script>
<script src="{% static 'js/competitor-modal.js' %}"></script>
<script src="{% static 'js/member-filter.js' %}"></script>
<script src="{% static 'js/member-search.js' %}"></script>
{% endblock %}
